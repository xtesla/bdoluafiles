PaGlobal_Atoraxion_Enter = {
  _ui = {
    stc_topBg = nil,
    btn_Close = nil,
    stc_CenterEffect = nil,
    txt_Title = nil,
    stc_SelectBg = nil,
    stc_KeySlot = {},
    stc_Locked = nil,
    txt_Desc = nil,
    btn_link = nil,
    btn_EnterBottom = nil,
    stc_keyGuide = nil,
    stc_keyGuide_A = nil,
    stc_keyGuide_B = nil,
    stc_keyGuide_X = nil
  },
  _instancefieldInfo = {
    _type = nil,
    _mode = nil,
    _mapKey = nil,
    _isReJoin = false,
    _lastJoinedServer = -1,
    _uniqueIndex = 1
  },
  _slotConfig = {createIcon = true, createCount = false},
  _mapData = {
    [__eInstanceAtoraxion_Hadum] = {
      _itemKey = 757204,
      _itemContentType = __eContentsType_AtoraxionHadumEnter,
      _bgLightTexture = "Combine/Etc/Combine_Etc_Atoraxion_Boss.dds",
      _bgLightUV = {
        x1 = 0,
        y1 = 546,
        x2 = 1920,
        y2 = 776
      },
      _bgTexture = "Combine/Etc/Combine_Etc_Atoraxion_Boss.dds",
      _bgUV = {
        x1 = 0,
        y1 = 0,
        x2 = 1920,
        y2 = 545
      },
      _btnTexture = "Combine/Btn/Combine_Btn_02.dds",
      _btnBaseUV = {
        x1 = 1,
        y1 = 203,
        x2 = 51,
        y2 = 253
      },
      _btnOnOverUV = {
        x1 = 52,
        y1 = 203,
        x2 = 102,
        y2 = 253
      },
      _title = PAGetString(Defines.StringSheet_GAME, "LUA_ATORAXION_ENTER_TITLE_0"),
      _desc = PAGetString(Defines.StringSheet_GAME, "LUA_ATORAXION_SEAL_DESC_0"),
      _titleEffect = "fUI_Atoraxion_Title_01A",
      _titleColor = Defines.Color.C_FFF5BA3A,
      _reJoinDesc = PAGetString(Defines.StringSheet_GAME, "LUA_ATORAXXION_ENTER_RE"),
      _msgKeyLack = PAGetString(Defines.StringSheet_GAME, "LUA_ATORAXXION_BOSS_ENTER_MSG_KEY"),
      _centerEffect = "fUI_Atoraxion_All_01A",
      _enterEffect = "fUI_Atoraxion_Button_01A"
    },
    [__eInstanceAtoraxion_Normal] = {
      _itemKey = 757164,
      _itemContentType = __eContentsType_AtoraxionNormalEnter,
      _bgLightTexture = "Combine/Etc/Combine_Etc_Atoraxion_Boss.dds",
      _bgLightUV = {
        x1 = 0,
        y1 = 546,
        x2 = 1920,
        y2 = 776
      },
      _bgTexture = "Combine/Etc/Combine_Etc_Atoraxion_Boss.dds",
      _bgUV = {
        x1 = 0,
        y1 = 0,
        x2 = 1920,
        y2 = 545
      },
      _btnTexture = "Combine/Btn/Combine_Btn_02.dds",
      _btnBaseUV = {
        x1 = 1,
        y1 = 203,
        x2 = 51,
        y2 = 253
      },
      _btnOnOverUV = {
        x1 = 52,
        y1 = 203,
        x2 = 102,
        y2 = 253
      },
      _title = PAGetString(Defines.StringSheet_GAME, "LUA_ATORAXION_ENTER_TITLE_0"),
      _desc = PAGetString(Defines.StringSheet_GAME, "LUA_ATORAXION_SEAL_DESC_0"),
      _titleEffect = "fUI_Atoraxion_Title_01A",
      _titleColor = Defines.Color.C_FFF5BA3A,
      _reJoinDesc = PAGetString(Defines.StringSheet_GAME, "LUA_ATORAXXION_ENTER_RE"),
      _msgKeyLack = PAGetString(Defines.StringSheet_GAME, "LUA_ATORAXXION_BOSS_ENTER_MSG_KEY"),
      _centerEffect = "fUI_Atoraxion_All_01A",
      _enterEffect = "fUI_Atoraxion_Button_01A"
    },
    [__eInstanceAtoraxionSea_Hadum] = {
      _itemKey = 757280,
      _itemContentType = __eContentsType_AtoraxionSeaHadumEnter,
      _bgLightTexture = "Combine/Etc/Combine_Etc_Atoraxion_Boss_01.dds",
      _bgLightUV = {
        x1 = 0,
        y1 = 546,
        x2 = 1920,
        y2 = 776
      },
      _bgTexture = "Combine/Etc/Combine_Etc_Atoraxion_Boss_01.dds",
      _bgUV = {
        x1 = 0,
        y1 = 0,
        x2 = 1920,
        y2 = 545
      },
      _btnTexture = "Combine/Btn/Combine_Btn_02.dds",
      _btnBaseUV = {
        x1 = 1,
        y1 = 282,
        x2 = 51,
        y2 = 332
      },
      _btnOnOverUV = {
        x1 = 52,
        y1 = 282,
        x2 = 102,
        y2 = 332
      },
      _title = PAGetString(Defines.StringSheet_GAME, "LUA_ATORAXION_ENTER_TITLE_1"),
      _desc = PAGetString(Defines.StringSheet_GAME, "LUA_ATORAXION_SEAL_DESC_1"),
      _titleEffect = "fUI_Atoraxion_Title_02A",
      _titleColor = Defines.Color.C_FF58FAFF,
      _reJoinDesc = PAGetString(Defines.StringSheet_GAME, "LUA_ATORAXXTION_ENTER_RE_SEA"),
      _msgKeyLack = PAGetString(Defines.StringSheet_GAME, "LUA_ATORAXXTION_BOSS_ENTER_MSG_KEY_SEA"),
      _centerEffect = "fUI_Atoraxion_All_02A",
      _enterEffect = "fUI_Atoraxion_Button_02A"
    },
    [__eInstanceAtoraxionSea_Normal] = {
      _itemKey = 757272,
      _itemContentType = __eContentsType_AtoraxionSeaNormalEnter,
      _bgLightTexture = "Combine/Etc/Combine_Etc_Atoraxion_Boss_01.dds",
      _bgLightUV = {
        x1 = 0,
        y1 = 546,
        x2 = 1920,
        y2 = 776
      },
      _bgTexture = "Combine/Etc/Combine_Etc_Atoraxion_Boss_01.dds",
      _bgUV = {
        x1 = 0,
        y1 = 0,
        x2 = 1920,
        y2 = 545
      },
      _btnTexture = "Combine/Btn/Combine_Btn_02.dds",
      _btnBaseUV = {
        x1 = 1,
        y1 = 282,
        x2 = 51,
        y2 = 332
      },
      _btnOnOverUV = {
        x1 = 52,
        y1 = 282,
        x2 = 102,
        y2 = 332
      },
      _title = PAGetString(Defines.StringSheet_GAME, "LUA_ATORAXION_ENTER_TITLE_1"),
      _desc = PAGetString(Defines.StringSheet_GAME, "LUA_ATORAXION_SEAL_DESC_1"),
      _titleEffect = "fUI_Atoraxion_Title_02A",
      _titleColor = Defines.Color.C_FF58FAFF,
      _reJoinDesc = PAGetString(Defines.StringSheet_GAME, "LUA_ATORAXXTION_ENTER_RE_SEA"),
      _msgKeyLack = PAGetString(Defines.StringSheet_GAME, "LUA_ATORAXXTION_BOSS_ENTER_MSG_KEY_SEA"),
      _centerEffect = "fUI_Atoraxion_All_02A",
      _enterEffect = "fUI_Atoraxion_Button_02A"
    }
  },
  _partyMaxCount = 5,
  _settedKeyCount = 0,
  _isConsole = false,
  _initialize = false
}
registerEvent("FromClient_luaLoadComplete", "FromClient_Atoraxion_Enter_Init")
function FromClient_Atoraxion_Enter_Init()
  PaGlobal_Atoraxion_Enter:initialize()
end
function PaGlobal_Atoraxion_Enter:initialize()
  if true == PaGlobal_Atoraxion_Enter._initialize or nil == Panel_Atoraxion_Enter then
    return
  end
  self._ui.stc_topBg = UI.getChildControl(Panel_Atoraxion_Enter, "Static_TitleArea")
  self._ui.txt_Title = UI.getChildControl(self._ui.stc_topBg, "StaticText_TItle")
  self._ui.stc_SelectBg = UI.getChildControl(Panel_Atoraxion_Enter, "Static_SelectBG")
  for idx = 1, self._partyMaxCount do
    local iconSlot = {_bg = nil, _slot = nil}
    local tempSlot = {}
    iconSlot._bg = UI.getChildControl(self._ui.stc_SelectBg, "Static_ItemSlot_" .. tostring(idx))
    SlotItem.new(tempSlot, "AtoraxionKey_Icon_", idx, iconSlot._bg, self._slotConfig)
    tempSlot:createChild()
    tempSlot.icon:SetSize(50, 50)
    tempSlot.icon:ComputePos()
    iconSlot._slot = tempSlot
    self._ui.stc_KeySlot[idx] = iconSlot
  end
  self._ui.stc_CenterEffect = UI.getChildControl(self._ui.stc_SelectBg, "Button_Enter")
  self._ui.stc_Locked = UI.getChildControl(self._ui.stc_SelectBg, "Static_BTN_Locked")
  local stc_Desc = UI.getChildControl(Panel_Atoraxion_Enter, "Static_Desc")
  self._ui.txt_Desc = UI.getChildControl(stc_Desc, "StaticText_Desc")
  self._ui.btn_link = UI.getChildControl(Panel_Atoraxion_Enter, "Button_Link_Key")
  self._ui.btn_EnterBottom = UI.getChildControl(Panel_Atoraxion_Enter, "Button_Enter_PartyLeader")
  self._ui.btn_Close = UI.getChildControl(Panel_Atoraxion_Enter, "Button_Close")
  self._ui.stc_keyGuide = UI.getChildControl(Panel_Atoraxion_Enter, "Static_KeyGuide_ConsoleUI")
  self._ui.stc_keyGuide_A = UI.getChildControl(self._ui.stc_keyGuide, "StaticText_A_ConsoleUI")
  self._ui.stc_keyGuide_B = UI.getChildControl(self._ui.stc_keyGuide, "StaticText_B_ConsoleUI")
  self._ui.stc_keyGuide_X = UI.getChildControl(self._ui.stc_keyGuide, "StaticText_X_ConsoleUI")
  self._isConsole = _ContentsGroup_UsePadSnapping
  PaGlobal_Atoraxion_Enter:validate()
  PaGlobal_Atoraxion_Enter:registEventHandler()
  PaGlobal_Atoraxion_Enter:swichPlatform(self._isConsole)
  self._initialize = true
end
function PaGlobal_Atoraxion_Enter:registEventHandler()
  if nil == Panel_Atoraxion_Enter then
    return
  end
  registerEvent("ResponseParty_withdraw", "FromClient_Atoraxion_Enter_Update")
  registerEvent("FromClient_InstanceFieldEnterUIWithDialogOpen", "FromClient_Atoraxion_Enter_Open")
  registerEvent("FromClient_UpdateAtoraxionStatusCheck", "FromClient_Atoraxion_Enter_Update")
  self._ui.btn_EnterBottom:addInputEvent("Mouse_LUp", "HandleEventLUp_Atoraxion_EnterBossRoom()")
  self._ui.btn_link:addInputEvent("Mouse_LUp", "HandleEventLUp_Atoraxion_RequestKeySet()")
  self._ui.btn_Close:addInputEvent("Mouse_LUp", "PaGlobalFunc_Atoraxion_Enter_Close()")
end
function PaGlobal_Atoraxion_Enter:swichPlatform(isConsole)
  self._ui.stc_keyGuide:SetShow(isConsole)
  self._ui.btn_Close:SetShow(false == isConsole)
  self._ui.btn_link:SetShow(false == isConsole)
  self._ui.btn_EnterBottom:SetShow(false == isConsole)
  if true == isConsole then
    Panel_Atoraxion_Enter:registerPadEvent(__eConsoleUIPadEvent_Up_X, "HandleEventLUp_Atoraxion_EnterBossRoom()")
  else
  end
end
function PaGlobal_Atoraxion_Enter:padKeyAlign()
  local temp = {
    self._ui.stc_keyGuide_X,
    self._ui.stc_keyGuide_A,
    self._ui.stc_keyGuide_B
  }
  PaGlobalFunc_ConsoleKeyGuide_SetAlign(temp, self._ui.stc_keyGuide, CONSOLEKEYGUID_ALIGN_TYPE.eALIGN_TYPE_CENTER)
end
function PaGlobal_Atoraxion_Enter:prepareOpen()
  if nil == Panel_Atoraxion_Enter then
    return
  end
  audioPostEvent_SystemUi(4, 15)
  _AudioPostEvent_SystemUiForXBOX(4, 15)
  audioPostEvent_SystemUi(4, 16)
  _AudioPostEvent_SystemUiForXBOX(4, 16)
  FromClient_Atoraxion_Enter_OnScreenResize()
  PaGlobal_Atoraxion_Enter:changeMapData()
  PaGlobal_Atoraxion_Enter:update()
  PaGlobal_Atoraxion_Enter:open()
end
function PaGlobal_Atoraxion_Enter:update()
  for idx = 1, self._partyMaxCount do
    if nil ~= self._ui.stc_KeySlot[idx] then
      self._ui.stc_KeySlot[idx]._slot:clearItem()
      self._ui.stc_KeySlot[idx]._slot.icon:EraseAllEffect()
    end
  end
  self._ui.btn_EnterBottom:EraseAllEffect()
  self._ui.stc_CenterEffect:EraseAllEffect()
  local mapData = self._mapData[self._instancefieldInfo._mapKey]
  if nil == mapData then
    return
  end
  local itemEnchantKey = ItemEnchantKey(mapData._itemKey, 0)
  if nil == itemEnchantKey then
    return
  end
  if false == itemEnchantKey:isDefined() then
    return
  end
  local itemWrapper = getItemEnchantStaticStatus(itemEnchantKey)
  if nil == itemWrapper then
    return
  end
  if true == self._isConsole then
    self._ui.stc_keyGuide_A:SetShow(true)
    PaGlobal_Atoraxion_Enter:padKeyAlign()
    Panel_Atoraxion_Enter:registerPadEvent(__eConsoleUIPadEvent_Up_A, "HandleEventLUp_Atoraxion_RequestKeySet()")
  else
    self._ui.btn_link:SetIgnore(false)
    self._ui.btn_link:SetMonoTone(false, false)
    self._ui.btn_link:SetShow(false == self._isConsole)
  end
  if true == self._instancefieldInfo._isReJoin then
    for index = 1, self._partyMaxCount do
      if nil ~= self._ui.stc_KeySlot[index] then
        self._ui.stc_KeySlot[index]._slot:setItemByStaticStatus(itemWrapper, 1)
      end
    end
    audioPostEvent_SystemUi(4, 19)
    _AudioPostEvent_SystemUiForXBOX(4, 19)
    audioPostEvent_SystemUi(4, 17)
    _AudioPostEvent_SystemUiForXBOX(4, 17)
    self._ui.stc_CenterEffect:AddEffect(mapData._centerEffect, true, 0, 0)
    self._ui.btn_EnterBottom:AddEffect(mapData._enterEffect, true, 0, 0)
    if true == self._isConsole then
      self._ui.stc_keyGuide_A:SetShow(false)
      Panel_Atoraxion_Enter:registerPadEvent(__eConsoleUIPadEvent_Up_A, "")
      PaGlobal_Atoraxion_Enter:padKeyAlign()
    else
      self._ui.btn_link:SetIgnore(true)
      self._ui.btn_link:SetMonoTone(true, true)
    end
  else
    self._settedKeyCount = 0
    local partyMemberCount = RequestParty_getPartyMemberCount()
    if partyMemberCount <= 0 then
      return
    end
    for index = 1, partyMemberCount do
      local memberData = RequestParty_getPartyMemberAt(index - 1)
      if nil ~= memberData then
        local isSelfPlayer = RequestParty_isSelfPlayer(index - 1)
        if true == memberData:isAtoraxionReady() then
          if nil ~= self._ui.stc_KeySlot[index] then
            self._ui.stc_KeySlot[index]._slot:setItemByStaticStatus(itemWrapper, 1)
            self._settedKeyCount = self._settedKeyCount + 1
            self._ui.stc_KeySlot[index]._slot.icon:AddEffect("fUI_Atoraxion_Item_02A", true, 0, 0)
            audioPostEvent_SystemUi(4, 18)
            _AudioPostEvent_SystemUiForXBOX(4, 18)
            if true == isSelfPlayer then
              if true == self._isConsole then
                self._ui.stc_keyGuide_A:SetShow(false)
                Panel_Atoraxion_Enter:registerPadEvent(__eConsoleUIPadEvent_Up_A, "")
                PaGlobal_Atoraxion_Enter:padKeyAlign()
              else
                self._ui.btn_link:SetIgnore(true)
                self._ui.btn_link:SetMonoTone(true, true)
              end
            end
          end
        elseif nil ~= self._ui.stc_KeySlot[index] and true == isSelfPlayer then
          self._ui.stc_KeySlot[index]._slot.icon:AddEffect("fUI_Atoraxion_Item_01A", true, 0, 0)
        end
      end
    end
    if self._partyMaxCount == self._settedKeyCount then
      self._ui.stc_CenterEffect:AddEffect(mapData._centerEffect, true, 0, 0)
      self._ui.btn_EnterBottom:AddEffect(mapData._enterEffect, true, 0, 0)
      if true == self._isConsole then
        self._ui.stc_keyGuide_A:SetShow(false)
        PaGlobal_Atoraxion_Enter:padKeyAlign()
        Panel_Atoraxion_Enter:registerPadEvent(__eConsoleUIPadEvent_Up_A, "")
      else
        self._ui.btn_link:SetIgnore(true)
        self._ui.btn_link:SetMonoTone(true, true)
      end
      audioPostEvent_SystemUi(4, 19)
      _AudioPostEvent_SystemUiForXBOX(4, 19)
      audioPostEvent_SystemUi(4, 17)
      _AudioPostEvent_SystemUiForXBOX(4, 17)
    end
  end
end
function PaGlobal_Atoraxion_Enter:changeMapData()
  if nil == Panel_Atoraxion_Enter then
    return
  end
  local mapData = self._mapData[self._instancefieldInfo._mapKey]
  if nil == mapData then
    return
  end
  self._ui.stc_topBg:ChangeTextureInfoName(mapData._bgLightTexture)
  local x1, y1, x2, y2 = setTextureUV_Func(self._ui.stc_topBg, mapData._bgLightUV.x1, mapData._bgLightUV.y1, mapData._bgLightUV.x2, mapData._bgLightUV.y2)
  self._ui.stc_topBg:getBaseTexture():setUV(x1, y1, x2, y2)
  self._ui.stc_topBg:setRenderTexture(self._ui.stc_topBg:getBaseTexture())
  self._ui.stc_SelectBg:ChangeTextureInfoName(mapData._bgTexture)
  local x1, y1, x2, y2 = setTextureUV_Func(self._ui.stc_SelectBg, mapData._bgUV.x1, mapData._bgUV.y1, mapData._bgUV.x2, mapData._bgUV.y2)
  self._ui.stc_SelectBg:getBaseTexture():setUV(x1, y1, x2, y2)
  self._ui.stc_SelectBg:setRenderTexture(self._ui.stc_SelectBg:getBaseTexture())
  self._ui.btn_Close:ChangeTextureInfoName(mapData._btnTexture)
  self._ui.btn_link:ChangeTextureInfoName(mapData._btnTexture)
  self._ui.btn_EnterBottom:ChangeTextureInfoName(mapData._btnTexture)
  x1, y1, x2, y2 = setTextureUV_Func(self._ui.btn_Close, mapData._btnBaseUV.x1, mapData._btnBaseUV.y1, mapData._btnBaseUV.x2, mapData._btnBaseUV.y2)
  self._ui.btn_Close:getBaseTexture():setUV(x1, y1, x2, y2)
  self._ui.btn_link:getBaseTexture():setUV(x1, y1, x2, y2)
  self._ui.btn_EnterBottom:getBaseTexture():setUV(x1, y1, x2, y2)
  self._ui.btn_Close:setRenderTexture(self._ui.btn_Close:getBaseTexture())
  self._ui.btn_link:setRenderTexture(self._ui.btn_link:getBaseTexture())
  self._ui.btn_EnterBottom:setRenderTexture(self._ui.btn_EnterBottom:getBaseTexture())
  x1, y1, x2, y2 = setTextureUV_Func(self._ui.btn_Close, mapData._btnOnOverUV.x1, mapData._btnOnOverUV.y1, mapData._btnOnOverUV.x2, mapData._btnOnOverUV.y2)
  self._ui.btn_Close:getOnTexture():setUV(x1, y1, x2, y2)
  self._ui.btn_link:getOnTexture():setUV(x1, y1, x2, y2)
  self._ui.btn_EnterBottom:getOnTexture():setUV(x1, y1, x2, y2)
  self._ui.btn_Close:getClickTexture():setUV(x1, y1, x2, y2)
  self._ui.btn_link:getClickTexture():setUV(x1, y1, x2, y2)
  self._ui.btn_EnterBottom:getClickTexture():setUV(x1, y1, x2, y2)
  self._ui.txt_Title:SetFontColor(mapData._titleColor)
  self._ui.txt_Title:SetText(mapData._title)
  self._ui.txt_Desc:SetText(mapData._desc)
end
function PaGlobal_Atoraxion_Enter:open()
  if nil == Panel_Atoraxion_Enter then
    return
  end
  Panel_Atoraxion_Enter:SetShow(true)
end
function PaGlobal_Atoraxion_Enter:prepareClose()
  if nil == Panel_Atoraxion_Enter then
    return
  end
  PaGlobal_Atoraxion_Enter:clear()
  PaGlobal_Atoraxion_Enter:close()
end
function PaGlobal_Atoraxion_Enter:clear()
  self._instancefieldInfo._type = nil
  self._instancefieldInfo._mode = nil
  self._instancefieldInfo._mapKey = nil
  self._instancefieldInfo._lastJoinedServer = nil
  self._instancefieldInfo._isReJoin = nil
  self._instancefieldInfo._uniqueIndex = nil
end
function PaGlobal_Atoraxion_Enter:close()
  if nil == Panel_Atoraxion_Enter then
    return
  end
  Panel_Atoraxion_Enter:SetShow(false)
end
function PaGlobal_Atoraxion_Enter:validate()
  if nil == Panel_Atoraxion_Enter then
    return
  end
  self._ui.stc_topBg:isValidate()
  self._ui.txt_Title:isValidate()
  self._ui.btn_Close:isValidate()
  self._ui.stc_SelectBg:isValidate()
  self._ui.stc_Locked:isValidate()
  self._ui.txt_Desc:isValidate()
  self._ui.btn_link:isValidate()
  self._ui.btn_EnterBottom:isValidate()
  self._ui.stc_keyGuide:isValidate()
  self._ui.stc_keyGuide_A:isValidate()
  self._ui.stc_keyGuide_B:isValidate()
  self._ui.stc_keyGuide_X:isValidate()
  self._ui.stc_CenterEffect:isValidate()
end
function PaGlobal_Atoraxion_Enter:hasItem()
  local selfProxy = getSelfPlayer():get()
  if nil == selfProxy then
    return
  end
  if nil == self._instancefieldInfo._mapKey then
    return false
  end
  local mapData = self._mapData[self._instancefieldInfo._mapKey]
  if nil == mapData then
    return false
  end
  local hasItem = doHaveContentsItem(mapData._itemContentType, 0, false)
  if false == hasItem then
    return false
  end
  return true
end
function FromClient_Atoraxion_Enter_OnScreenResize()
  if nil == Panel_Atoraxion_Enter then
    return
  end
  local screenX = getScreenSizeX()
  local screenY = getScreenSizeY()
  Panel_Atoraxion_Enter:SetSize(screenX, screenY)
  Panel_Atoraxion_Enter:ComputePosAllChild()
end
function PaGlobalFunc_Atoraxion_Enter_Close()
  PaGlobal_Atoraxion_Enter:prepareClose()
end
function FromClient_Atoraxion_Enter_Update()
  if nil ~= Panel_Atoraxion_Enter and true == Panel_Atoraxion_Enter:GetShow() then
    PaGlobal_Atoraxion_Enter:update()
  end
end
function FromClient_Atoraxion_Enter_Open(type, mode, mapkey, lastJoinedServerNo, isRejoin, uniqueIndex)
  if nil == Panel_Atoraxion_Enter then
    return
  end
  local selfPlayer = getSelfPlayer()
  if nil == selfPlayer then
    return
  end
  if true == selfPlayer:isInstancePlayer() then
    return
  end
  PaGlobal_Atoraxion_Enter._instancefieldInfo._type = type
  PaGlobal_Atoraxion_Enter._instancefieldInfo._mode = mode
  PaGlobal_Atoraxion_Enter._instancefieldInfo._mapKey = mapkey
  PaGlobal_Atoraxion_Enter._instancefieldInfo._lastJoinedServer = lastJoinedServerNo
  PaGlobal_Atoraxion_Enter._instancefieldInfo._isReJoin = isRejoin
  PaGlobal_Atoraxion_Enter._instancefieldInfo._uniqueIndex = uniqueIndex
  PaGlobal_Atoraxion_Enter._ui.txt_Title:EraseAllEffect()
  if nil ~= PaGlobal_Atoraxion_Enter._mapData[mapkey] then
    PaGlobal_Atoraxion_Enter._ui.txt_Title:AddEffect(PaGlobal_Atoraxion_Enter._mapData[mapkey]._titleEffect, true, 0, 0)
  end
  PaGlobal_Atoraxion_Enter:prepareOpen()
end
function HandleEventLUp_Atoraxion_RequestKeySet()
  if CppEnums.PartyType.ePartyType_Large == ToClient_GetPartyType() then
    Proc_ShowMessage_Ack(PAGetString(Defines.StringSheet_GAME, "LUA_ATORAXXION_MSG_GROUP"))
    return
  end
  if false == PaGlobal_Atoraxion_Enter:hasItem() then
    Proc_ShowMessage_Ack(PAGetString(Defines.StringSheet_GAME, "LUA_CHATNEW_NO_HAVE_ITEM"))
    return
  end
  if nil == PaGlobal_Atoraxion_Enter._instancefieldInfo._mapKey then
    Proc_ShowMessage_Ack(PAGetString(Defines.StringSheet_SymbolNo, "eErrNoParameterIsInvalid"))
    return
  end
  ToClient_requestSetAtoraxionKey(PaGlobal_Atoraxion_Enter._instancefieldInfo._mapKey)
end
function HandleEventLUp_Atoraxion_EnterBossRoom()
  if nil == PaGlobal_Atoraxion_Enter then
    return
  end
  local info = PaGlobal_Atoraxion_Enter._instancefieldInfo
  if nil == info._type or nil == info._mode or nil == info._mapKey or nil == info._isReJoin then
    return
  end
  local mapData = PaGlobal_Atoraxion_Enter._mapData[info._mapKey]
  if nil == mapData then
    return
  end
  if false == info._isReJoin then
    if false == PaGlobal_Atoraxion_Enter:hasItem() then
      Proc_ShowMessage_Ack(PAGetString(Defines.StringSheet_GAME, "LUA_CHATNEW_NO_HAVE_ITEM"))
      return
    end
    if PaGlobal_Atoraxion_Enter._settedKeyCount < PaGlobal_Atoraxion_Enter._partyMaxCount then
      Proc_ShowMessage_Ack(mapData._msgKeyLack)
      return
    end
    local isPartyLeader = RequestParty_isLeader()
    if false == isPartyLeader then
      Proc_ShowMessage_Ack(PAGetString(Defines.StringSheet_GAME, "LUA_ATORAXXION_BOSS_ENTER_MSG_LEADER"))
      return
    end
  end
  local function enterAtoraxion()
    ToClient_requestEnterToAtoraxion(info._type, info._mode, info._mapKey, info._lastJoinedServer, info._isReJoin, info._uniqueIndex)
  end
  local MessageBoxData = {
    title = PAGetString(Defines.StringSheet_GAME, "LUA_COMMON_ALERT_NOTIFICATIONS"),
    content = PAGetString(Defines.StringSheet_GAME, "LUA_WINDOW_ATORAXION_ENTER_POPUP"),
    functionApply = enterAtoraxion,
    functionCancel = MessageBox_Empty_function,
    priority = CppEnums.PAUIMB_PRIORITY.PAUIMB_PRIORITY_LOW
  }
  if true == info._isReJoin then
    MessageBoxData.content = mapData._reJoinDesc
  end
  MessageBox.showMessageBox(MessageBoxData)
  audioPostEvent_SystemUi(4, 21)
  _AudioPostEvent_SystemUiForXBOX(4, 21)
  audioPostEvent_SystemUi(4, 19)
  _AudioPostEvent_SystemUiForXBOX(4, 19)
end
